<!DOCTYPE html>
<html>
<head>
    <title>Class Records</title>
</head>
<body>
    <a href="{% url 'home_adviser_teacher' %}">Back to Home</a><br>
    <a href="{% url 'get_grade_details' %}"> Create Class Record</a><br>
    <a href="">Final Grade and General Average</a><br>

    <script>
        function changeQuarter() {
            var selectedQuarter = document.getElementById("quarterSelection").value;
    
            // Assuming you have a URL named 'display_initial_grades'
            var url = "{% url 'display_initial_grades_view' quarter_name='your_quarter_placeholder' %}";
            
            // Replace placeholder with the actual selected quarter
            url = url.replace('your_quarter_placeholder', selectedQuarter);
    
            // Make an AJAX request to the Django view
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    // Update the page with the returned data
                    document.getElementById("initialGradesSection").innerHTML = xhr.responseText;
                }
            };
            xhr.open("GET", url, true);
            xhr.send();
        }
    </script>
   
    <label for="quarterSelection">Choose Quarter:</label>
    <select id="quarterSelection" onchange="changeQuarter()">
        <option value="quarter1">1st Quarter</option>
        <option value="quarter2">2nd Quarter</option>
        <option value="quarter3">3rd Quarter</option>
        <option value="quarter4">4th Quarter</option>
    </select>

    <!-- Update the button to include the quarter selection menu -->
    <button onclick="changeQuarter()">Show Summary</button>


<h1>Class Records</h1>

{% if class_records %}
    <table border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Grade</th>
                <th>Section</th>
                <th>Subject</th>
                <th>Teacher</th>
                <th>Quarters</th>
            </tr>
        </thead>
        <tbody>
            {% for record in class_records %}
                <tr>
                    <td>{{ record.id }}</td>
                    <td>{{ record.name }}</td>
                    <td>{{ record.grade }}</td>
                    <td>{{ record.section }}</td>
                    <td>{{ record.subject }}</td>
                    <td>{{ record.teacher.user.first_name }} {{ record.teacher.user.last_name }}</td>
                    <td>{{ record.quarters }}</td>
                    <td>
                        <a href="{% url 'display_classrecord' class_record_id=record.id %}">
                            <button>View Class Record</button>
                        </a>
                    </td>
                    <td>
                        <a href="{% url 'display_quarterly_summary' grade=record.grade section=record.section subject=record.subject %}">
                            <button>Quarterly Summary per Subject</button>
                        </a>
                    </td>
                    <td>
                        <a href="{% url 'display_final_grades' grade=record.grade section=record.section subject=record.subject %}">
                            <button>Show Final Grades per Subject </button>
                        </a>
                    </td>
                    <td>
                        <form method="post" action="{% url 'delete_classrecord' class_record_id=record.id %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit">Delete Class Record</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>No class records found.</p>
{% endif %}

</body>
</html>
